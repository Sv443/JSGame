<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<script src="jsgame.js" jsg_disable_watermark="false"></script>
		<style>
		body{
			font-family:"Calibri";
		}
		img:not(.jsg_menuclosebtn){
			border:1px solid black;
		}
		input[type="range"]{
			background-color:#fff;padding:3px;
		}
		</style>
	</head>
	<body>
		<h1><script>document.write(jsgi.name + " (" + jsgi.version + ") by " + jsgi.author);</script></h1>
		<h2><script>document.write(jsgi.desc);</script></h2>
		<br><br><br><br><br><br><br><br>
		
		
		<h2>Collision Detection</h2>
		<div id="collision_detection_wrapper" style="background-color:#dcdcdc;padding:10px;">
			Only works on &lt;img&gt; tags yet<br><br><br><br>
			<img id="coll-a" alt="coll-a" style="position:relative;left:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<img id="coll-b" alt="coll-b"><br><br>
			Colliding: <b><span id="trfa"></span></b><br><br>
			Move coll-b <input id="coll-b_mover" type="range" min="-4" max="10" value="3.0" step="0.1">
		</div>
		<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
		
		
		
		
		<h2>Raytracing</h2>
		<div id="collision_detection_wrapper" style="background-color:#dcdcdc;padding:10px;">
			<br><br><br><br><br><br><br><br><br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<img class="rc_enemy" src="https://sv443.net/resources/images/blank.png" style="width:60px;height:20px;background-color:#aaa;">
			<br><br><br><br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<img class="rc_enemy" src="https://sv443.net/resources/images/blank.png" style="width:100px;height:20px;background-color:#aaa;">
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<div id="rc_center" style="display:inline-block;width:50px;height:50px;background-color:red;"></div>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<img class="rc_enemy" src="https://sv443.net/resources/images/blank.png" style="width:50px;height:100px;background-color:#aaa;">
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<img class="rc_enemy" src="https://sv443.net/resources/images/blank.png" style="width:10px;height:150px;background-color:#aaa;">
			<br><br><br><br><br><br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<img class="rc_enemy" src="https://sv443.net/resources/images/blank.png" style="width:10px;height:20px;background-color:#aaa;">
			<br><br><br><br><br><br>
			
			Rotate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input id="rayrotinput" type="range" min="-360" max="360" value="0"><button onclick="gebid('rayrotinput').value='0'">&lt</button><br>
			Move anchor point <input id="moveanchorinput" type="range" min="-10" max="25" value="0" step="0.1"><button onclick="gebid('moveanchorinput').value='0'">&lt</button><br><br>
			Ray Width <input id="raywidthinput" type="number" onchange="raywidthsh(this.value)" min="1" max="10" value="1"> px (default: 2)<br><br>
			Ray Length <input id="raylengthinput" type="number" onchange="raylengthsh(this.value)" min="0" max="400" value="200" step="10"> px (default: 200)<br><br>
			Show Ray <input id="rayrotshowhide" type="checkbox" onchange="rayrotsh(this.checked)"><br>
			Show Colliders <input id="raycollshowhide" type="checkbox" onchange="raycollsh(this.checked)"><br>
			Rotate Infinitely <input id="rayinfrotate" type="checkbox" onchange="rayinfrotsh(this.checked)"><br><br>
			<button onclick="Ray.remove('rc_ray')">remove ray</button>
		</div>
		<br><br><br><br><br><br><br><br><br><br><br><br><br>
		
		
		
		

		<h2>Animation</h2>
		<div id="animation_wrapper" style="background-color:#dcdcdc;padding:10px;">
			<img id="anim1testelem" style="width:10em;height:10em;background-color:green;">
			<img id="anim2testelem" style="width:10em;height:10em;background-color:green;">
			<img id="anim3testelem" style="width:10em;height:10em;background-color:green;">
			<br>

			<button onclick="toggletestanim(1)" style="width:12em;">toggle on/off</button>
			<button onclick="toggletestanim(2)" style="width:12em;">toggle on/off</button>
			<button onclick="toggletestanim(3)" style="width:12em;">toggle on/off</button>
			<br><br><br><br><br><br>

			<img id="animidleplayerelem" style="width:12em;height:12em;">
			<img id="animwalkplayerelem" style="width:12em;height:12em;"><br>
			<a target="_blank" href="https://www.pinterest.de/pin/428827195759731182/">(source)</a>
			<br><br>

			Keep in mind that these are not videos or GIFs, but single images<br>
			The &lt;img&gt;-tag's src attributes are changed on interval according to the provided frames<br>
			Try inspecting the elements to see how the src's are changed
		</div>
		<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>








		<h2>Audio</h2>
		<div id="audio_wrapper" style="background-color:#dcdcdc;padding:10px;">
			Audio Time: <span id="audtimedisp"></span>
			<br><br>

			<button onclick="Audio.play('testaudio')">play/unpause audio</button> <button onclick="Audio.pause('testaudio')">pause audio</button> <button onclick="Audio.stop('testaudio')">stop audio</button><br>
			<button onclick="Audio.loop('testaudio', true)">enable loop</button> <button onclick="Audio.loop('testaudio', false)">disable loop</button><br><br>
			Set audio time <input type="range" onchange="Audio.setTime('testaudio', this.value)" value="0" min="0" max="16" step="0.1"><br>
			Volume <input type="range" id="audvolinput" value="1.0" min="0.0" max="1.0" step="0.01"> <span id="audiovoldisp"></span>
			<br><br>

			<a href="https://freesound.org/s/444398/" target="_blank">(Audio source)</a>
		</div>
		<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>







		<h2>Notifications</h2>
		<div id="notif_wrapper" style="background-color:#dcdcdc;padding:10px;">
			<button onclick="Notif.grant()">grant permission</button><br><br>
			<button onclick="Notif.send('Test Notification', 'click me to execute a function', 'https://picsum.photos/200/200/?random', function(){alert('click')})">send test notification</button><br><br>
			<form action="#">Custom notification <input type="text" id="notiftitlein" placeholder="title" required> <input type="text" id="notifbodyin" placeholder="body" required> <input type="text" id="notifimgin" placeholder="image src"> <button onclick="sendcustomnotif()">send</button></form>
		</div>
		<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>






		<h2>Menu</h2>
		<div id="menu_wrapper" style="background-color:#dcdcdc;padding:10px;">
			<button onclick="newMenu()">make demo menu</button> <button onclick="Menu.open('test')">open demo menu</button><br>
			<button onclick="Menu.theme('test', 'light')">light theme</button> <button onclick="Menu.theme('test', 'dark')">dark theme</button><br><br><br><br>
			<form action="#" onsubmit="alert('you will be put back to the top. This is due to me being lazy and has nothing to do with the script.\nplease just scroll down again.');">Custom menu <input type="text" id="cmenu_title" placeholder="title" required> <input type="text" id="cmenu_ihtml" placeholder="innerHTML" required> <input max="100" type="number" id="cmenu_width" placeholder="width" required> % <input max="100" type="number" id="cmenu_height" placeholder="height" required> % <button onclick="makecustommenu()">create</button></form>
			<button onclick="Menu.open('cm');">open custom menu</button><br>
			<button onclick="Menu.theme('cm', 'light')">light theme</button> <button onclick="Menu.theme('cm', 'dark')">dark theme</button>
		</div>
		<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

		

		<script>
			document.title=jsgi.name;


gebid("rayrotshowhide").checked = true;
gebid("raycollshowhide").checked = true;
gebid("rayinfrotate").checked = false;

setInterval(function() {
    if (Coll.isColliding(gebid("coll-a"), gebid("coll-b"))) gebid("trfa").innerHTML = "<span style='color:green;'>true</span>";
    else gebid("trfa").innerHTML = "<span style='color:red;'>false</span>";

    gebid("coll-b").style.position = "relative";
    gebid("coll-b").style.left = gebid("coll-b_mover").value + "%";

    if (gebid("coll-a").style.left.replace("px", "") >= 200) gebid("coll-a").style.left = "0px";
    else var f = 1;
    gebid("coll-a").style.left = parseInt(gebid("coll-a").style.left) + f + "px";
    if (!gebid("rayinfrotate").checked) rayrot(gebid("rayrotinput").value);

    gebid("rc_center").style.transition = "left 0.15s linear, bottom 0.15s linear";
    gebid("rc_center").style.left = (gebid("moveanchorinput").value) + "%";
}, 25);

Ray.cast("rc_ray", gebid("rc_center"), "200px", "2px", "0deg", gebcn("rc_enemy"), function(ret) {
    if (ret) {
        gebid("rc_center").style.backgroundColor = "green";
    } else {
        gebid("rc_center").style.backgroundColor = "red";
    }
}, 25, null, null);

function rayrot(rot) {
    Ray.rotate("rc_ray", rot + "deg", "linear");
}

function raywidthsh(value) {
    if (value > 5000) alert("well done, you just broke it ðŸ™„\n\n(Reload to reset back to normal)");
    Ray.changeAttribute("rc_ray", "width", value + "px");
}

function raylengthsh(value) {
    Ray.changeAttribute("rc_ray", "length", value + "px");
}

function rayrotsh(checked) {
    if (checked) gebid("jsg_ray_rc_ray").style.border = "1px solid black";
    else if (!checked) gebid("jsg_ray_rc_ray").style.border = "0px solid black";
}

function raycollsh(checked) {
    if (checked) {
        for (var i = 0; i < gebcn("jsg_ray_rc_ray_raybcs").length; i++) {
            gebcn("jsg_ray_rc_ray_raybcs")[i].style.border = "1px solid black";
        }
    } else if (!checked) {
        for (var i = 0; i < gebcn("jsg_ray_rc_ray_raybcs").length; i++) {
            gebcn("jsg_ray_rc_ray_raybcs")[i].style.border = "0px solid black";
        }
    }
}

var allowinfrot = false,
    incc = 0;

function rayinfrotsh(checked) {
    if(checked) {
        incc = 0;
        allowinfrot = true;
        setInterval(function() {
            if (allowinfrot) {
                Ray.rotate("rc_ray", incc + "deg", "linear");
                incc++;
            }
        }, 25);
    } else {
        Ray.rotate("rc_ray", "0deg", "linear");
        allowinfrot = false;
    }
}




var testanim_states = ["1.png", "2.png", "3.png", "4.png"];


Anim.new("testanim1", gebid("anim1testelem"), testanim_states, 1000);
Anim.toggle("testanim1", "off");
gebid("anim1testelem").style.backgroundColor = "red";

Anim.new("testanim2", gebid("anim2testelem"), testanim_states, 500);
Anim.toggle("testanim2", "off");
gebid("anim2testelem").style.backgroundColor = "red";

Anim.new("testanim3", gebid("anim3testelem"), testanim_states, 150);
Anim.toggle("testanim3", "off");
gebid("anim3testelem").style.backgroundColor = "red";


function toggletestanim(id) {
    if (gebid("anim" + id + "testelem").dataset.anim_toggled == "on") {
        Anim.toggle("testanim" + id, "off");
        gebid("anim" + id + "testelem").style.backgroundColor = "red";
    }
    else {
        Anim.toggle("testanim" + id, "on");
        gebid("anim" + id + "testelem").style.backgroundColor = "green";
    }
}


var player_idle_animstates = ["anim/idle/0.png", "anim/idle/1.png"];
var player_walk_animstates = ["anim/walk/0.png", "anim/walk/1.png", "anim/walk/2.png", "anim/walk/3.png", "anim/walk/4.png", "anim/walk/5.png", "anim/walk/6.png", "anim/walk/7.png"];

Anim.new("playeranim", gebid("animidleplayerelem"), player_idle_animstates, 400);
Anim.new("playeranim", gebid("animwalkplayerelem"), player_walk_animstates, 75);







Audio.new("testaudio", "https://sv443.net/cdn/other/testaudio.wav", true);

setInterval(audvol, 20);

function audvol() {
    Audio.volume('testaudio', gebid("audvolinput").value);
    gebid("audiovoldisp").innerHTML=gebid("audvolinput").value;

    try{gebid("audtimedisp").innerHTML=Math.round(parseFloat(Audio.getTime("testaudio")) * 10) / 10 + "s";}catch{}
}





function sendcustomnotif() {
    Notif.send(gebid("notiftitlein").value, gebid("notifbodyin").value, gebid("notifimgin").value);
}





menu_innerhtml = "<div style='text-align:center;'><h3>This is the menu that gets made by the Menu.new() function of the Menu class</h3>"
+ "You can use the innerhtml argument to add <u>every</u> <sub>HTML</sub> <i>tag</i> <sup>you</sup> <s>want</s>.<br>"
+ "For example <button>buttons</button>, <input placeholder='inputs'> and even iframes:<br><br><iframe src='https://www.example.org'></iframe><br><br>"
+ "This can for example be used to make a settings menu:<br>"
+ "Music: <input type='range'><br>"
+ "SFX: <input type='range'><br>"
+ "Anti-Aliasing: <input type='checkbox' checked><br><br><br>"
+ "You can use the button in the top right or the ESC key to close this menu (fully configurable).</div>";

function newMenu() {
    // (id, title, innerhtml, width, height, border_rounded, closable_ESC, closable_btn, on_close, close_img_src)
    Menu.new("test", "Menu Class", menu_innerhtml, 50, 70, true, true, true, function(){alert("closed");});
}

function makecustommenu() {
    Menu.new("cm", gebid("cmenu_title").value, gebid("cmenu_ihtml").value, parseInt(gebid("cmenu_width").value), parseInt(gebid("cmenu_height").value), true, true, true);
}
		</script>
	</body>
</html>
